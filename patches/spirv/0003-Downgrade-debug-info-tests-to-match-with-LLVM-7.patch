From 9e48a870ef12418e1aefa771b616e6f279363958 Mon Sep 17 00:00:00 2001
From: Alexey Sotkin <alexey.sotkin@intel.com>
Date: Fri, 2 Nov 2018 18:05:57 +0300
Subject: [PATCH] Downgrade debug info tests to match with LLVM 7

Change-Id: Ie3dfefc28c0d4bedcd06413658a0752e243f17cb
---
 test/DebugInfo/X86/constant-loclist.ll     | 2 +-
 test/DebugInfo/X86/dw_op_minus_direct.ll   | 2 +-
 test/DebugInfo/X86/live-debug-variables.ll | 2 +-
 test/DebugInfo/X86/partial-constant.ll     | 2 +-
 test/RelativeSrcPath.ll                    | 2 +-
 test/SingleOpLine.ll                       | 2 +-
 6 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/test/DebugInfo/X86/constant-loclist.ll b/test/DebugInfo/X86/constant-loclist.ll
index 3834af9..151a4c6 100644
--- a/test/DebugInfo/X86/constant-loclist.ll
+++ b/test/DebugInfo/X86/constant-loclist.ll
@@ -18,7 +18,7 @@
 ; CHECK-NEXT: DW_AT_name {{.*}}"i"
 ; CHECK: DW_TAG_variable
 ; CHECK-NEXT: DW_AT_location [DW_FORM_data4]	(
-; CHECK-NEXT:   0x{{.*}}, 0x{{.*}}: DW_OP_lit0
+; CHECK-NEXT:   0x{{.*}}, 0x{{.*}}: DW_OP_constu 0x0 
 ; CHECK-NEXT:   0x{{.*}}, 0x{{.*}}: DW_OP_constu 0x4000000000000000)
 ; CHECK-NEXT: DW_AT_name {{.*}}"u"
 
diff --git a/test/DebugInfo/X86/dw_op_minus_direct.ll b/test/DebugInfo/X86/dw_op_minus_direct.ll
index e2d1403..e5ea188 100644
--- a/test/DebugInfo/X86/dw_op_minus_direct.ll
+++ b/test/DebugInfo/X86/dw_op_minus_direct.ll
@@ -21,7 +21,7 @@
 
 ; CHECK: .debug_loc contents:
 ; CHECK: 0x00000000:
-; CHECK-NEXT:   [0x0000000000000000, 0x0000000000000004): DW_OP_breg0 RAX+0, DW_OP_constu 0xffffffff, DW_OP_and, DW_OP_lit1, DW_OP_minus, DW_OP_stack_value
+; CHECK-NEXT:   [0x0000000000000000, 0x0000000000000004): DW_OP_breg0 RAX+0, DW_OP_constu 0xffffffff, DW_OP_and, DW_OP_constu 0x1, DW_OP_minus, DW_OP_stack_value
 ;        rax+0, constu 0xffffffff, and, constu 0x00000001, minus, stack-value
 
 source_filename = "minus.c"
diff --git a/test/DebugInfo/X86/live-debug-variables.ll b/test/DebugInfo/X86/live-debug-variables.ll
index fab66d6..0ac825c 100644
--- a/test/DebugInfo/X86/live-debug-variables.ll
+++ b/test/DebugInfo/X86/live-debug-variables.ll
@@ -29,7 +29,7 @@
 ; CHECK:      .debug_loc contents:
 ; CHECK-NEXT: 0x00000000:
 ;   We currently emit an entry for the function prologue, too, which could be optimized away.
-; CHECK:              [0x0000000000000018, 0x0000000000000072): DW_OP_reg3 RBX
+; CHECK:              [0x000000000000001f, 0x000000000000003c): DW_OP_reg3 RBX
 ;   We should only have one entry inside the function.
 ; CHECK-NOT: :
 
diff --git a/test/DebugInfo/X86/partial-constant.ll b/test/DebugInfo/X86/partial-constant.ll
index 1373543..e763858 100644
--- a/test/DebugInfo/X86/partial-constant.ll
+++ b/test/DebugInfo/X86/partial-constant.ll
@@ -22,7 +22,7 @@
 ; CHECK-NOT: DW_AT_const_value
 ; CHECK: .debug_loc contents:
 ; CHECK-NEXT: 0x00000000:
-; CHECK-NEXT:   {{.*}}: DW_OP_lit1, DW_OP_stack_value
+; CHECK-NEXT:   {{.*}}: DW_OP_constu 0x1, DW_OP_stack_value
 
 source_filename = "test.ii"
 target datalayout = "e-m:o-i64:64-f80:128-n8:16:32:64-S128"
diff --git a/test/RelativeSrcPath.ll b/test/RelativeSrcPath.ll
index 71e0453..f7ffaf7 100644
--- a/test/RelativeSrcPath.ll
+++ b/test/RelativeSrcPath.ll
@@ -42,7 +42,7 @@ attributes #0 = { convergent noinline nounwind optnone "correctly-rounded-divide
 !opencl.spir.version = !{!6}
 !llvm.ident = !{!7}
 
-!0 = distinct !DICompileUnit(language: DW_LANG_C99, file: !1, producer: "clang version 8.0.0 (cfe/trunk)", isOptimized: false, runtimeVersion: 0, emissionKind: LineTablesOnly, enums: !2, nameTableKind: None)
+!0 = distinct !DICompileUnit(language: DW_LANG_C99, file: !1, producer: "clang version 8.0.0 (cfe/trunk)", isOptimized: false, runtimeVersion: 0, emissionKind: LineTablesOnly, enums: !2)
 !1 = !DIFile(filename: "<stdin>", directory: "/tmp")
 !2 = !{}
 !3 = !{i32 2, !"Debug Info Version", i32 3}
diff --git a/test/SingleOpLine.ll b/test/SingleOpLine.ll
index ccf6b88..c6c981c 100644
--- a/test/SingleOpLine.ll
+++ b/test/SingleOpLine.ll
@@ -31,7 +31,7 @@ attributes #0 = { convergent noinline nounwind optnone "correctly-rounded-divide
 !opencl.compiler.options = !{!2}
 !llvm.ident = !{!7}
 
-!0 = distinct !DICompileUnit(language: DW_LANG_C99, file: !1, producer: "clang version 8.0.0 (cfe/trunk)", isOptimized: false, runtimeVersion: 0, emissionKind: LineTablesOnly, enums: !2, nameTableKind: None)
+!0 = distinct !DICompileUnit(language: DW_LANG_C99, file: !1, producer: "clang version 8.0.0 (cfe/trunk)", isOptimized: false, runtimeVersion: 0, emissionKind: LineTablesOnly, enums: !2)
 !1 = !DIFile(filename: "/tmp/<stdin>", directory: "/tmp")
 !2 = !{}
 !3 = !{i32 2, !"Debug Info Version", i32 3}
-- 
1.8.3.1

